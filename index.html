<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Тест взрыва</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/3.4.7/aframe/build/aframe-ar-nft.js"></script>
</head>
<body>

  <a-scene embedded arjs="trackingMethod:best;sourceType:webcam;debugUIEnabled:false" 
           renderer="antialias:true" style="height:100vh">

    <a-assets timeout="120000">
      <a-asset-item id="destruction" src="destruction.glb"></a-asset-item>
    </a-assets>

    <!-- Одна модель для теста -->
    <a-box position="0 1.6 -3" color="red" depth="0.6" height="0.6" width="0.6" 
           class="clickable"></a-box>

    <!-- Взрыв — изначально скрыт -->
    <a-entity id="explosion" 
              gltf-model="#destruction" 
              visible="false" 
              scale="0.8 0.8 0.8"
              position="0 1.6 -3">
    </a-entity>

    <a-camera>
      <a-cursor></a-cursor>
    </a-camera>
  </a-scene>

  <script>
    // Ждём загрузки сцены
    AFRAME.registerComponent('test-explosion', {
      init: function () {
        const explosion = document.querySelector('#explosion');
        const box = document.querySelector('.clickable');

        box.addEventListener('click', () => {
          console.log('Клик! Запускаем взрыв...');
          explosion.setAttribute('visible', true);
          explosion.setAttribute('animation-mixer', 'clip:*;loop:once;timeScale:1');
        });
      }
    });

    // Привязываем компонент к сцене
    document.querySelector('a-scene').setAttribute('test-explosion', '');
  </script>

</body>
</html>
